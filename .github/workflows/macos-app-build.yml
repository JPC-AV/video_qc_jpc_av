- name: Install dependencies with universal PyQt6
      env:
        # Force universal binary compilation
        ARCHFLAGS: "-arch x86_64 -arch arm64"
        CFLAGS: "-arch x86_64 -arch arm64"
        CXXFLAGS: "-arch x86_64 -arch arm64"
        LDFLAGS: "-arch x86_64 -arch arm64"
      run: |
        python -m pip install --upgrade pip
        pip install pyinstaller
        
        # Install specific universal PyQt6 wheels
        echo "Installing universal PyQt6 components..."
        pip install --force-reinstall --no-cache-dir \
          "PyQt6-sip>=13.8,<14" \
          "PyQt6>=6.7.1" \
          --prefer-binary \
          --only-binary=all \
          --platform macosx_10_14_universal2 \
          --no-deps
          
        # Install PyQt6-Qt6 universal binary specifically
        pip install --force-reinstall --no-cache-dir \
          "PyQt6-Qt6>=6.9.0,<6.10.0" \
          --prefer-binary \
          --only-binary=all \
          --platform macosx_11_0_universal2 \
          --no-deps
        
        # Install other dependencies
        pip install -e . --no-deps
        
        # Install remaining dependencies normally
        pip install appdirs colorlog art "lxml>=5.2.0" plotly toml tenacity
